
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.1.3">
    
    
      
        <title>SeqLike API Reference - SeqLike</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.edf004c2.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/apidocs.css">
    
      <link rel="stylesheet" href="../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#seqlike-api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="SeqLike" class="md-header__button md-logo" aria-label="SeqLike" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M448 360V24c0-13.3-10.7-24-24-24H96C43 0 0 43 0 96v320c0 53 43 96 96 96h328c13.3 0 24-10.7 24-24v-16c0-7.5-3.5-14.3-8.9-18.7-4.2-15.4-4.2-59.3 0-74.7 5.4-4.3 8.9-11.1 8.9-18.6zM128 134c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm0 64c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm253.4 250H96c-17.7 0-32-14.3-32-32 0-17.6 14.4-32 32-32h285.4c-1.9 17.1-1.9 46.9 0 64z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SeqLike
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SeqLike API Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/modernatx/seqlike" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    modernatx/seqlike
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="SeqLike" class="md-nav__button md-logo" aria-label="SeqLike" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M448 360V24c0-13.3-10.7-24-24-24H96C43 0 0 43 0 96v320c0 53 43 96 96 96h328c13.3 0 24-10.7 24-24v-16c0-7.5-3.5-14.3-8.9-18.7-4.2-15.4-4.2-59.3 0-74.7 5.4-4.3 8.9-11.1 8.9-18.6zM128 134c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm0 64c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm253.4 250H96c-17.7 0-32-14.3-32-32 0-17.6 14.4-32 32-32h285.4c-1.9 17.1-1.9 46.9 0 64z"/></svg>

    </a>
    SeqLike
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/modernatx/seqlike" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    modernatx/seqlike
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        SeqLike: Flexible Biological Sequence Objects in Python
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Development
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Development" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../development/devcontainer/" class="md-nav__link">
        Development Containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../development/development-environment/" class="md-nav__link">
        Setting up your development environment manually
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../development/documentation/" class="md-nav__link">
        Documentation Standards and Practices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../development/import-speed/" class="md-nav__link">
        Optimizing for Import Speed
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../development/seqlike-object/" class="md-nav__link">
        The SeqLike Object
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../development/versioning/" class="md-nav__link">
        Versioning
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Notebooks
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Notebooks" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Notebooks
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/sequence-like/" class="md-nav__link">
        Sequence like
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/tutorial/" class="md-nav__link">
        Tutorial
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../align_commandline/" class="md-nav__link">
        Alignment Command-Line Bridge
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../alignment_commands/" class="md-nav__link">
        Alignment Commands
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../alignment_utils/" class="md-nav__link">
        Alignment Utilities
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../alphabets/" class="md-nav__link">
        Alphabets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../codon_tables/" class="md-nav__link">
        Codon Tables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../draw_utils/" class="md-nav__link">
        Drawing Utilities
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../encoders/" class="md-nav__link">
        Encoders
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          SeqLike API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        SeqLike API Reference
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike" class="md-nav__link">
    seqlike.SeqLike
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike" class="md-nav__link">
    SeqLike
  </a>
  
    <nav class="md-nav" aria-label="SeqLike">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.__add__" class="md-nav__link">
    __add__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.__deepcopy__" class="md-nav__link">
    __deepcopy__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.__dir__" class="md-nav__link">
    __dir__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.__getattr__" class="md-nav__link">
    __getattr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.__getitem__" class="md-nav__link">
    __getitem__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.__radd__" class="md-nav__link">
    __radd__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.__setattr__" class="md-nav__link">
    __setattr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.aa" class="md-nav__link">
    aa()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.back_translate" class="md-nav__link">
    back_translate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.nt" class="md-nav__link">
    nt()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.pad_to" class="md-nav__link">
    pad_to()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.reverse_complement" class="md-nav__link">
    reverse_complement()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.seq_num_to_idx" class="md-nav__link">
    seq_num_to_idx()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.slice" class="md-nav__link">
    slice()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.to_seq" class="md-nav__link">
    to_seq()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.to_seqrecord" class="md-nav__link">
    to_seqrecord()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.translate" class="md-nav__link">
    translate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.ungap" class="md-nav__link">
    ungap()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.upper" class="md-nav__link">
    upper()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike.aaSeqLike" class="md-nav__link">
    aaSeqLike()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike.determine__type" class="md-nav__link">
    determine__type()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike.determine__type_and_alphabet" class="md-nav__link">
    determine__type_and_alphabet()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike.determine_alphabet" class="md-nav__link">
    determine_alphabet()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike.ntSeqLike" class="md-nav__link">
    ntSeqLike()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike.record_from" class="md-nav__link">
    record_from()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike.swap_representation" class="md-nav__link">
    swap_representation()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike.validate_codon_map" class="md-nav__link">
    validate_codon_map()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike.validate_sequence" class="md-nav__link">
    validate_sequence()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../seqlike_accessor/" class="md-nav__link">
        SeqLike Accessor API
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike" class="md-nav__link">
    seqlike.SeqLike
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike" class="md-nav__link">
    SeqLike
  </a>
  
    <nav class="md-nav" aria-label="SeqLike">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.__add__" class="md-nav__link">
    __add__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.__deepcopy__" class="md-nav__link">
    __deepcopy__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.__dir__" class="md-nav__link">
    __dir__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.__getattr__" class="md-nav__link">
    __getattr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.__getitem__" class="md-nav__link">
    __getitem__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.__radd__" class="md-nav__link">
    __radd__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.__setattr__" class="md-nav__link">
    __setattr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.aa" class="md-nav__link">
    aa()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.back_translate" class="md-nav__link">
    back_translate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.nt" class="md-nav__link">
    nt()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.pad_to" class="md-nav__link">
    pad_to()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.reverse_complement" class="md-nav__link">
    reverse_complement()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.seq_num_to_idx" class="md-nav__link">
    seq_num_to_idx()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.slice" class="md-nav__link">
    slice()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.to_seq" class="md-nav__link">
    to_seq()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.to_seqrecord" class="md-nav__link">
    to_seqrecord()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.translate" class="md-nav__link">
    translate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.ungap" class="md-nav__link">
    ungap()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seqlike.SeqLike.SeqLike.upper" class="md-nav__link">
    upper()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike.aaSeqLike" class="md-nav__link">
    aaSeqLike()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike.determine__type" class="md-nav__link">
    determine__type()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike.determine__type_and_alphabet" class="md-nav__link">
    determine__type_and_alphabet()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike.determine_alphabet" class="md-nav__link">
    determine_alphabet()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike.ntSeqLike" class="md-nav__link">
    ntSeqLike()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike.record_from" class="md-nav__link">
    record_from()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike.swap_representation" class="md-nav__link">
    swap_representation()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike.validate_codon_map" class="md-nav__link">
    validate_codon_map()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seqlike.SeqLike.validate_sequence" class="md-nav__link">
    validate_sequence()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/modernatx/seqlike/edit/master/docs/reference/seqlike.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="seqlike-api-reference">SeqLike API Reference</h1>


<div class="doc doc-object doc-module">


<a id="seqlike.SeqLike"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="seqlike.SeqLike.SeqLike" class="doc doc-heading">
        <code>SeqLike</code>


</h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="seqlike.SequenceLike.SequenceLike">SequenceLike</span></code></p>

  
      <p>An omnibus object for various representations of biological sequences.</p>
<p>This class provides a simple way to interconvert between array,
string, Seq, and SeqRecord representations of biological sequences.
In general SeqLike objects try to act something like "dual SeqRecords",
where we have both nucleotide and amino acid representations.
All operations tend to act on the current selected form (NT or AA),
and we strive to keep the representations in sync whenever possible.</p>
<p>Here's a quick usage example:</p>
<pre><code class="language-python">from seqlike import SeqLike
example = 'ATCGATC'

seq_record = SeqLike(example, seq_type=&quot;nt&quot;).to_seqrecord()
seq = SeqLike(example, seq_type=&quot;nt&quot;).to_seq()
seq_str = SeqLike(example, seq_type=&quot;nt&quot;).to_str()
seq_index = SeqLike(example, seq_type=&quot;nt&quot;).to_index()
seq_onehot = SeqLike(example, seq_type=&quot;nt&quot;).to_onehot()
</code></pre>
<p>Any of the aformentioned representations can be generated or passed in as an input.
If using onehot or index encodings, they are of the shape:
(N x NUM_BASES) and (N), respectively.
We use symbols from our extended nucleotide and protein alphabets.
These allow for gaps (<code>-</code>), stops (<code>*</code>),
and additional amino acid letters.
For more info, please see the <em>_onehot_encoder and </em><em>index_encoder objects,
and specifically, their categories</em> attributes.</p>
<p>We also allow switching between the NT and AA views of the object.</p>
<pre><code class="language-python"># conversion to AA
aa_example = SeqLike(example).aa()

# conversion to NT
example_orig = aa_example.nt()
</code></pre>
<p>The constructor also takes optional keyword arguments
that are passed on to SeqRecord.
For the id attribute, if unspecified we generate a random hexadecimal UUID.</p>
<p><code>codon_map</code> defines back-translation from an AA sequence to a NT sequence.
This is formatted as a callable, see <code>codon_tables.py</code> for more info.</p>
<p>If the sequence is an NT, then its length must be a multiple of 3 to be translated.
If it's not, then all AA attributes are None.
Likewise, if the initializing sequence is an AA,
but no codon_map was passed in, we can't generate a NT sequence.
We defer and calculate these on the fly under the hood if possible.</p>


        <details class="quote">
          <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SeqLike</span><span class="p">(</span><span class="n">SequenceLike</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An omnibus object for various representations of biological sequences.</span>

<span class="sd">    This class provides a simple way to interconvert between array,</span>
<span class="sd">    string, Seq, and SeqRecord representations of biological sequences.</span>
<span class="sd">    In general SeqLike objects try to act something like &quot;dual SeqRecords&quot;,</span>
<span class="sd">    where we have both nucleotide and amino acid representations.</span>
<span class="sd">    All operations tend to act on the current selected form (NT or AA),</span>
<span class="sd">    and we strive to keep the representations in sync whenever possible.</span>

<span class="sd">    Here&#39;s a quick usage example:</span>

<span class="sd">    ```python</span>
<span class="sd">    from seqlike import SeqLike</span>
<span class="sd">    example = &#39;ATCGATC&#39;</span>

<span class="sd">    seq_record = SeqLike(example, seq_type=&quot;nt&quot;).to_seqrecord()</span>
<span class="sd">    seq = SeqLike(example, seq_type=&quot;nt&quot;).to_seq()</span>
<span class="sd">    seq_str = SeqLike(example, seq_type=&quot;nt&quot;).to_str()</span>
<span class="sd">    seq_index = SeqLike(example, seq_type=&quot;nt&quot;).to_index()</span>
<span class="sd">    seq_onehot = SeqLike(example, seq_type=&quot;nt&quot;).to_onehot()</span>
<span class="sd">    ```</span>

<span class="sd">    Any of the aformentioned representations can be generated or passed in as an input.</span>
<span class="sd">    If using onehot or index encodings, they are of the shape:</span>
<span class="sd">    (N x NUM_BASES) and (N), respectively.</span>
<span class="sd">    We use symbols from our extended nucleotide and protein alphabets.</span>
<span class="sd">    These allow for gaps (`-`), stops (`*`),</span>
<span class="sd">    and additional amino acid letters.</span>
<span class="sd">    For more info, please see the *_onehot_encoder and *_index_encoder objects,</span>
<span class="sd">    and specifically, their categories_ attributes.</span>

<span class="sd">    We also allow switching between the NT and AA views of the object.</span>

<span class="sd">    ```python</span>
<span class="sd">    # conversion to AA</span>
<span class="sd">    aa_example = SeqLike(example).aa()</span>

<span class="sd">    # conversion to NT</span>
<span class="sd">    example_orig = aa_example.nt()</span>
<span class="sd">    ```</span>

<span class="sd">    The constructor also takes optional keyword arguments</span>
<span class="sd">    that are passed on to SeqRecord.</span>
<span class="sd">    For the id attribute, if unspecified we generate a random hexadecimal UUID.</span>

<span class="sd">    `codon_map` defines back-translation from an AA sequence to a NT sequence.</span>
<span class="sd">    This is formatted as a callable, see `codon_tables.py` for more info.</span>

<span class="sd">    If the sequence is an NT, then its length must be a multiple of 3 to be translated.</span>
<span class="sd">    If it&#39;s not, then all AA attributes are None.</span>
<span class="sd">    Likewise, if the initializing sequence is an AA,</span>
<span class="sd">    but no codon_map was passed in, we can&#39;t generate a NT sequence.</span>
<span class="sd">    We defer and calculate these on the fly under the hood if possible.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">sequence</span><span class="p">:</span> <span class="n">SeqLikeType</span><span class="p">,</span>
        <span class="n">seq_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">alphabet</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">codon_map</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize a SeqLike object.</span>

<span class="sd">        :param sequence: String, Seq, SeqRecord, SeqLike, List, NumPy ndarray, PyTorch Tensor</span>
<span class="sd">        :param seq_type: one of &#39;NT&#39;, &#39;DNA&#39;, &#39;RNA&#39; or &#39;AA&#39;, case insensitive</span>
<span class="sd">        :param alphabet: one of &#39;standard&#39;, &#39;full&#39;, or a custom string of alphabet letters</span>
<span class="sd">        :param codon_map: a callable, see codon_tables.py for more info.</span>
<span class="sd">        :param **kwargs: keyword arguments for internal SeqRecord attribute</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="p">(</span>
            <span class="n">_type</span><span class="p">,</span>
            <span class="n">_aa_record</span><span class="p">,</span>
            <span class="n">_nt_record</span><span class="p">,</span>
            <span class="n">alphabet</span><span class="p">,</span>
            <span class="n">codon_map</span><span class="p">,</span>
            <span class="n">_index_encoder</span><span class="p">,</span>
            <span class="n">_onehot_encoder</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="n">_construct_seqlike</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">seq_type</span><span class="p">,</span> <span class="n">alphabet</span><span class="p">,</span> <span class="n">codon_map</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span> <span class="o">=</span> <span class="n">alphabet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_index_encoder</span> <span class="o">=</span> <span class="n">_index_encoder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_onehot_encoder</span> <span class="o">=</span> <span class="n">_onehot_encoder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span> <span class="o">=</span> <span class="n">_aa_record</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span> <span class="o">=</span> <span class="n">_nt_record</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span> <span class="k">if</span> <span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;AA&quot;</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span> <span class="o">=</span> <span class="n">codon_map</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="o">.</span><span class="n">seq</span>

    <span class="k">def</span> <span class="nf">nt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auto_backtranslate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SeqLike&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method returns the NT view of the SeqLike object.</span>

<span class="sd">        The method will automagically back-translate the `._aa_record`</span>
<span class="sd">        of its SeqLike object if the `._nt_record` does not exist.</span>

<span class="sd">        :param auto_backtranslate: Whether or not</span>
<span class="sd">            to automagically back-translate an AA sequence into an NT sequence.</span>
<span class="sd">            Defaults to True.</span>
<span class="sd">        :param kwargs: Passed through to `.back_translate()`.</span>
<span class="sd">            Can include `codon_map` to specify which codon map to use.</span>
<span class="sd">        :returns: The NT view of the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Start with auto-back-translation</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">auto_backtranslate</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">back_translate</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;NT&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">swap_representation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auto_translate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SeqLike&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the amino acid view of the SeqLike object.</span>

<span class="sd">        The method will automagically translate the `._nt_record`</span>
<span class="sd">        of its SeqLike object if the `._aa_record` does not exist.</span>

<span class="sd">        We preserve all NT record attributes for convenience in sequence manipulation</span>
<span class="sd">        tasks where the starter sequence is an NT and we merely want the AA form.</span>
<span class="sd">        The default behaviour, thus, has `id=True`, `name=True`, `description=True`,</span>
<span class="sd">        `annotations=True`, and `dbxrefs=True`.</span>

<span class="sd">        To change the behaviour,</span>
<span class="sd">        you can set any of those to False in `.aa()`, for example:</span>

<span class="sd">        ```python</span>
<span class="sd">        seq.aa(id=False)</span>
<span class="sd">        ```</span>

<span class="sd">        :param auto_translate: Whether to automagically translate</span>
<span class="sd">            an NT sequence into an AA sequence.</span>
<span class="sd">            Defaults to True.</span>
<span class="sd">        :param kwargs: These kwargs are passed into BioPython SeqRecord&#39;s</span>
<span class="sd">            `.translate()` method.  The default behaviour is set to `id=True`,</span>
<span class="sd">            `name=True`, `description=True`, `annotations=True`, and `dbxrefs=True`.</span>
<span class="sd">        :returns: copy of self with sequence object as amino acid sequence.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Start with auto-translation</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">auto_translate</span><span class="p">:</span>
            <span class="n">translate_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">annotations</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dbxrefs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">translate_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="o">**</span><span class="n">translate_kwargs</span><span class="p">)</span>

        <span class="c1"># Return based on _type.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;AA&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">swap_representation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="c1"># ------------------------- Methods to inter-convert Sequence to various Biopython formats -------------------------</span>
    <span class="c1"># Function to convert the input sequence object to Seq object</span>
    <span class="k">def</span> <span class="nf">to_seq</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Seq</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the SeqLike object (string, Seq, SeqRecord) to a BioPython Seq object.</span>

<span class="sd">        :returns: A Seq object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Seq</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="o">.</span><span class="n">seq</span><span class="p">))</span>

    <span class="c1"># Function to convert input sequence to SeqRecord object</span>
    <span class="k">def</span> <span class="nf">to_seqrecord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SeqRecord</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the SeqLike object (string, Seq, SeqRecord) to a BioPython SeqRecord.</span>

<span class="sd">        :param **kwargs: Used to set the attributes of the SeqRecord.</span>
<span class="sd">            Overrides the original SeqRecord&#39;s attributes.</span>
<span class="sd">        :returns: A SeqRecord object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span>
        <span class="n">newrec</span> <span class="o">=</span> <span class="n">SeqRecord</span><span class="p">(</span>
            <span class="n">Seq</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">seq</span><span class="p">)),</span>
            <span class="nb">id</span><span class="o">=</span><span class="n">rec</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="n">rec</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">rec</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
            <span class="n">dbxrefs</span><span class="o">=</span><span class="n">rec</span><span class="o">.</span><span class="n">dbxrefs</span><span class="p">[:],</span>
            <span class="n">features</span><span class="o">=</span><span class="n">rec</span><span class="o">.</span><span class="n">features</span><span class="p">[:],</span>
            <span class="n">annotations</span><span class="o">=</span><span class="n">rec</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
            <span class="n">letter_annotations</span><span class="o">=</span><span class="n">rec</span><span class="o">.</span><span class="n">letter_annotations</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
        <span class="p">)</span>
        <span class="c1"># overwrite newrec values with keyword args</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">newrec</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">newrec</span>

    <span class="c1"># ------------------------- Functions to apply callables -------------------------</span>
    <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SeqLike&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Translate the SeqLike._nt_record and add a ._aa_record.</span>

<span class="sd">        Returns the `.aa()` view of the SeqLike object.</span>

<span class="sd">        :param kwargs: These kwargs are passed into</span>
<span class="sd">            BioPython SeqRecord&#39;s `.translate()` method.</span>
<span class="sd">            They can be used to set SeqRecord properties.</span>
<span class="sd">        :returns: A translated SeqLike object.</span>
<span class="sd">        :raises ValueError: When we&#39;re trying to translate a SeqLike object</span>
<span class="sd">            that doesn&#39;t have an NT record.</span>
<span class="sd">        :raises TypeError: When we&#39;re trying to translate a nucleotide sequence</span>
<span class="sd">            that isn&#39;t a multiple of 3.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sc</span><span class="o">.</span><span class="n">_nt_record</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Oops! It looks like you&#39;re trying to translate a SeqLike object &quot;</span>
                <span class="s2">&quot;that doesn&#39;t have a nucleotide record set. &quot;</span>
                <span class="s2">&quot;Unfortunately this would be semantically incorrect. &quot;</span>
                <span class="s2">&quot;Please ensure that your SeqLike has a `._nt_record` SeqRecord &quot;</span>
                <span class="s2">&quot;before calling on `.translate()`.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;Oh no! It looks like you&#39;re trying to translate a nucleotide sequence &quot;</span>
                <span class="s2">&quot;whose length is not a multiple of 3. &quot;</span>
                <span class="s2">&quot;As a safeguard, SeqLike objects do not allow this to happen. &quot;</span>
            <span class="p">)</span>
        <span class="n">sc</span><span class="o">.</span><span class="n">_nt_record</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;molecule_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;DNA&quot;</span>
        <span class="n">sc</span><span class="o">.</span><span class="n">_aa_record</span> <span class="o">=</span> <span class="n">record_from</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">_nt_record</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">gap</span><span class="o">=</span><span class="n">gap_letter</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">sc</span><span class="o">.</span><span class="n">aa</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">back_translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">codon_map</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SeqLike&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;This method backtranslates the current AA sequence and returns an</span>
<span class="sd">        NT sequence.</span>

<span class="sd">        We expect that self.codon_map will be defined, and if not, we</span>
<span class="sd">        expect a callable and its arguments to be passed into this</span>
<span class="sd">        method, as either the first positional argument or by using</span>
<span class="sd">        keyword arguments.  Any other arguments for the back</span>
<span class="sd">        translator should use keyword arguments.</span>

<span class="sd">        If `codon_map` is one of the keyword arguments or the sole</span>
<span class="sd">        positional argument, we override self.codon_map, with the</span>
<span class="sd">        associated value, and pass all kwargs through to it, along</span>
<span class="sd">        with self.  Otherwise we use self.codon_map.</span>

<span class="sd">        Finally, we use self.apply to apply the codon_map callable to</span>
<span class="sd">        the current sequence.</span>

<span class="sd">        :param codon_map: A codon map callable.</span>
<span class="sd">        :param **kwargs: Passed through to the codon_map function.</span>
<span class="sd">        :returns: A new NT seqlike.</span>
<span class="sd">        :raises AttributeError: if no codon map is passed in</span>
<span class="sd">            when the SeqLike&#39;s `codon_map` is also not set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># normally, we wouldn&#39;t have to do this sort of thing, we could</span>
        <span class="c1"># just use self.__dict__ in the codon_map function.</span>

        <span class="c1"># but we might want to use a different codon_map than the original</span>
        <span class="c1"># object, so we have to copy and set codon_map in the copy as to not</span>
        <span class="c1"># modify in-place.</span>

        <span class="n">codon_map</span> <span class="o">=</span> <span class="n">codon_map</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span>

        <span class="k">if</span> <span class="n">codon_map</span><span class="p">:</span>
            <span class="n">validate_codon_map</span><span class="p">(</span><span class="n">codon_map</span><span class="p">)</span>
            <span class="n">sc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">codon_map</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># returns a deepcopied SeqLike</span>

            <span class="c1"># TODO: Change this to an if/raise block.</span>
            <span class="k">assert</span> <span class="p">(</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">SeqLike</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sc</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;NT&quot;</span>
            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Backtranslating function must return an NT SeqLike, type was </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s2">&quot;No callable passed and self.codon_map not set!  &quot;</span>
                <span class="s2">&quot;Please set the codon_map attribute or pass in a &quot;</span>
                <span class="s2">&quot;callable using the `codon_map` keyword.&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">sc</span><span class="o">.</span><span class="n">nt</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">reverse_complement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SeqLike&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return reverse complement of NT sequence.</span>

<span class="sd">        Record this operation in annotations[&#39;reversed&#39;].</span>
<span class="sd">        If sequence is currently AA, raise exception like Bio.Seq.Seq.complement()</span>

<span class="sd">        :param **kwargs: Not currently used.</span>
<span class="sd">        :returns: Reverse-complemented SeqLike object.</span>
<span class="sd">        :raises ValueError: when trying to reverse-complement an AA sequence.</span>
<span class="sd">            This is a semantically invalid operation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;AA&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Proteins do not have complements!&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;annotations&quot;</span><span class="p">):</span>
            <span class="n">annotations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">annotations</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="k">if</span> <span class="s2">&quot;reversed&quot;</span> <span class="ow">in</span> <span class="n">annotations</span><span class="p">:</span>
            <span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;reversed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;reversed&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;reversed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">_nt_record</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span><span class="o">.</span><span class="n">reverse_complement</span><span class="p">(</span>
            <span class="nb">id</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">annotations</span><span class="o">=</span><span class="n">annotations</span><span class="p">,</span> <span class="n">dbxrefs</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="n">s</span> <span class="o">=</span> <span class="n">SeqLike</span><span class="p">(</span>
            <span class="n">_nt_record</span><span class="p">,</span>
            <span class="n">seq_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span>
            <span class="n">alphabet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="p">,</span>
            <span class="n">codon_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="c1"># ------------------------- Functions to format sequences -------------------------</span>
    <span class="k">def</span> <span class="nf">ungap</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SeqLike&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove gap characters and return a new SeqLike.</span>

<span class="sd">        :returns: An ungapped SeqLike with no gap characters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_seq</span> <span class="o">=</span> <span class="n">ungap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_seqrecord</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">SeqLike</span><span class="p">(</span>
            <span class="n">new_seq</span><span class="p">,</span>
            <span class="n">seq_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span>
            <span class="n">alphabet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="p">,</span>
            <span class="n">codon_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span><span class="p">,</span>
            <span class="n">index_encoder</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_index_encoder</span><span class="p">,</span>
            <span class="n">onehot_encoder</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_onehot_encoder</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">pad_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">pad_char</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">gap_letter</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SeqLike&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;This method returns a new SeqLike, with gap characters added to the left</span>
<span class="sd">        or right to make a sequence of the specified length. Note that this method</span>
<span class="sd">        retains only the current view!</span>

<span class="sd">        :param new_length: An integer &gt;= than current length</span>
<span class="sd">        :param pad_char: The padding character</span>
<span class="sd">        :param mode: one of &#39;left&#39; or &#39;right&#39;</span>
<span class="sd">        :returns: new SeqLike</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_length</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">))</span>
        <span class="k">assert</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">]</span>

        <span class="n">diff</span> <span class="o">=</span> <span class="n">new_length</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">diff</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Current length is </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2"> and &quot;</span>
            <span class="s2">&quot;requested padded length is </span><span class="si">{new_length}</span><span class="s2">.&quot;</span>
            <span class="s2">&quot; Can&#39;t do negative padding&quot;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">SeqLike</span><span class="p">(</span>
                <span class="n">pad_char</span> <span class="o">*</span> <span class="n">diff</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="p">,</span>
                <span class="n">seq_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span>
                <span class="n">alphabet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="p">,</span>
                <span class="n">codon_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span><span class="p">,</span>
                <span class="n">index_encoder</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_index_encoder</span><span class="p">,</span>
                <span class="n">onehot_encoder</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_onehot_encoder</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">SeqLike</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span> <span class="o">+</span> <span class="n">pad_char</span> <span class="o">*</span> <span class="n">diff</span><span class="p">,</span>
                <span class="n">seq_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span>
                <span class="n">alphabet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="p">,</span>
                <span class="n">codon_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span><span class="p">,</span>
                <span class="n">index_encoder</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_index_encoder</span><span class="p">,</span>
                <span class="n">onehot_encoder</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_onehot_encoder</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">seq_num_to_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_of_seqnums</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Convert seqnum to idx.</span>

<span class="sd">        TODO: This docstring might need to be made better. tag Andrew Giessel.</span>

<span class="sd">        :param list_of_seqnums: Something.</span>
<span class="sd">        :returns: Something.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">ranger</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;TODO: Docstrings need to be added here. tag Andrew Giessel.</span>

<span class="sd">            :param i: Something</span>
<span class="sd">            :yields: Something</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">b</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="nb">slice</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">seqnums_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">seqnum</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">seqnum</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">letter_annotations</span><span class="p">[</span><span class="s2">&quot;seqnums&quot;</span><span class="p">]))</span>
        <span class="n">seqnums</span> <span class="o">=</span> <span class="p">[</span><span class="n">seqnums_map</span><span class="p">[</span><span class="n">seqnum</span><span class="p">]</span> <span class="k">for</span> <span class="n">seqnum</span> <span class="ow">in</span> <span class="n">list_of_seqnums</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">ranger</span><span class="p">(</span><span class="n">seqnums</span><span class="p">))</span>

    <span class="c1"># ------------------------- String-like methods -----------------------------------</span>
    <span class="k">def</span> <span class="nf">upper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return uppercase sequences and alphabet.</span>

<span class="sd">        &lt;!-- #noqa: DAR201 --&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">seq_copy</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">seq_copy</span><span class="o">.</span><span class="n">_seqrecord</span> <span class="o">=</span> <span class="n">seq_copy</span><span class="o">.</span><span class="n">_seqrecord</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">seq_copy</span><span class="o">.</span><span class="n">_nt_record</span><span class="p">:</span>
            <span class="n">seq_copy</span><span class="o">.</span><span class="n">_nt_record</span> <span class="o">=</span> <span class="n">seq_copy</span><span class="o">.</span><span class="n">_nt_record</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">seq_copy</span><span class="o">.</span><span class="n">_aa_record</span><span class="p">:</span>
            <span class="n">seq_copy</span><span class="o">.</span><span class="n">_aa_record</span> <span class="o">=</span> <span class="n">seq_copy</span><span class="o">.</span><span class="n">_aa_record</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">seq_copy</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">seq_copy</span><span class="o">.</span><span class="n">_type</span>
        <span class="n">seq_copy</span><span class="o">.</span><span class="n">alphabet</span> <span class="o">=</span> <span class="n">seq_copy</span><span class="o">.</span><span class="n">alphabet</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">seq_copy</span>

    <span class="k">def</span> <span class="nf">slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_of_seqnums</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Use seqnums to sub-index.</span>

<span class="sd">        TODO: This docstring needs to be much more improved.</span>

<span class="sd">        :param list_of_seqnums: Something</span>
<span class="sd">        :returns: Something</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seq_num_to_idx</span><span class="p">(</span><span class="n">list_of_seqnums</span><span class="p">))</span>

    <span class="c1"># ------------------------- Special methods ---------------------------------------</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a representation of the sequence.</span>

<span class="sd">        If both nucleotide and an associated amino acid sequence are present,</span>
<span class="sd">        we show both.</span>

<span class="sd">        &lt;!-- #noqa: DAR201 --&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;NT&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;*** NT: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="se">\n\n</span><span class="s2">AA: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;NT: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="se">\n\n</span><span class="s2">*** AA: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set attribute value</span>

<span class="sd">        We prioritize setting attribute in _seqrecord before the SeqLike object.</span>

<span class="sd">        &lt;!-- #noqa: DAR101 --&gt;</span>
<span class="sd">        &lt;!-- #noqa: DAR201 --&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">seqrecord_attrs</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Called if the attribute does not already exist in SeqLike</span>

<span class="sd">        Please see [the official Python reference][pyref] for more information.</span>

<span class="sd">        [pyref]: https://docs.python.org/3/reference/datamodel.html</span>

<span class="sd">        :param name: Attribute to return.</span>
<span class="sd">        :raises AttributeError: if the attribute is not a SeqLike</span>
<span class="sd">            or SeqRecord attribute.</span>

<span class="sd">        &lt;!-- #noqa: DAR201 --&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;__setstate__&quot;</span><span class="p">:</span>  <span class="c1"># pertains to pickling</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">seqrecord_attrs</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> not an attribute of SeqLike or SeqLike._seqrecord&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Override for dir() of a SeqLike&#39;s attributes.</span>

<span class="sd">        :returns: List of SeqLike attributes and SeqRecord attributes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__dir__</span><span class="p">()</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">seqrecord_attrs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SeqLike&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        __getitem__ implementation.</span>

<span class="sd">        Slicing on SeqLike will slice the associated sequence</span>
<span class="sd">        and return a sub-sequence SeqLike object.</span>
<span class="sd">        We try to cast the SeqLike to NT if possible,</span>
<span class="sd">        index,</span>
<span class="sd">        and then create a new sequence out of that.</span>
<span class="sd">        If the sub-sequence is not a multiple of three in length,</span>
<span class="sd">        then there will be no AA sequence associated with the new SeqLike,</span>
<span class="sd">        due to ambiguity of coding frame.</span>
<span class="sd">        This is simply the default behavior of the SeqLike constructor.</span>
<span class="sd">        Note that this *can* result in a new NT with AA that is out of frame,</span>
<span class="sd">        the constructor doesn&#39;t know or care.</span>

<span class="sd">        By convention, the indices here are in the &quot;units&quot; of the</span>
<span class="sd">        current type of SeqLike, i.e. in NTs if DNA or RNA, or AAs if AA</span>

<span class="sd">        :param index: integer or slice to access parts of the sequence.</span>
<span class="sd">        :returns: A new SeqLike of the same type sliced to the index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">slice</span><span class="p">))</span> <span class="k">else</span> <span class="n">index</span>

        <span class="c1"># slicing is a type-preserving</span>
        <span class="n">seqlike_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">seq_type</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">),</span>
            <span class="n">alphabet</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="p">),</span>
            <span class="n">codon_map</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="n">all_seqlikes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

            <span class="c1"># Handle case when both NT and AA are present:</span>
            <span class="c1"># - We need to slice BOTH the _nt_record and _aa_records.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Firstly, determine the primary and secondary records to slice based on _type</span>
                <span class="n">_aa_record</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span><span class="p">)</span>
                <span class="n">_nt_record</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;AA&quot;</span><span class="p">:</span>
                    <span class="c1"># Slice the AA followed by 3x boundaries.for NT</span>
                    <span class="n">_aa_record</span> <span class="o">=</span> <span class="n">_aa_record</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

                    <span class="n">start</span> <span class="o">=</span> <span class="n">idx</span><span class="o">.</span><span class="n">start</span> <span class="ow">or</span> <span class="mi">0</span>
                    <span class="n">stop</span> <span class="o">=</span> <span class="n">idx</span><span class="o">.</span><span class="n">stop</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                    <span class="n">step</span> <span class="o">=</span> <span class="n">idx</span><span class="o">.</span><span class="n">step</span> <span class="ow">or</span> <span class="mi">1</span>

                    <span class="n">new_nt_record</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">new_nt_record</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">new_nt_record</span> <span class="o">=</span> <span class="n">_nt_record</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="p">:</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">new_nt_record</span> <span class="o">=</span> <span class="n">new_nt_record</span> <span class="o">+</span> <span class="n">_nt_record</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="p">:</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">]</span>

                    <span class="n">sliced</span> <span class="o">=</span> <span class="n">SeqLike</span><span class="p">(</span><span class="n">_aa_record</span><span class="p">,</span> <span class="o">**</span><span class="n">seqlike_kwargs</span><span class="p">)</span>
                    <span class="n">sliced</span><span class="o">.</span><span class="n">_nt_record</span> <span class="o">=</span> <span class="n">new_nt_record</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;NT&quot;</span><span class="p">:</span>
                    <span class="n">_nt_record</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span><span class="p">)[</span><span class="n">idx</span><span class="p">]</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">_aa_record</span> <span class="o">=</span> <span class="n">_nt_record</span><span class="o">.</span><span class="n">translate</span><span class="p">()</span>
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                    <span class="n">sliced</span> <span class="o">=</span> <span class="n">SeqLike</span><span class="p">(</span><span class="n">_nt_record</span><span class="p">,</span> <span class="o">**</span><span class="n">seqlike_kwargs</span><span class="p">)</span>
                    <span class="n">sliced</span><span class="o">.</span><span class="n">_aa_record</span> <span class="o">=</span> <span class="n">_aa_record</span>

            <span class="c1"># _aa_record is only present</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;AA&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">sliced</span> <span class="o">=</span> <span class="n">SeqLike</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span><span class="p">)[</span><span class="n">idx</span><span class="p">],</span> <span class="o">**</span><span class="n">seqlike_kwargs</span><span class="p">)</span>

            <span class="c1"># _nt_record is only present</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;NT&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">sliced</span> <span class="o">=</span> <span class="n">SeqLike</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span><span class="p">)[</span><span class="n">idx</span><span class="p">],</span> <span class="o">**</span><span class="n">seqlike_kwargs</span><span class="p">)</span>

            <span class="n">all_seqlikes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sliced</span><span class="p">)</span>

        <span class="c1"># all_seqlikes is now a list of SeqLikes that we need to concatenate</span>
        <span class="k">return</span> <span class="n">reduce</span><span class="p">((</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">),</span> <span class="n">all_seqlikes</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add sequence to another sequence.</span>

<span class="sd">        Mimics behavior of SeqRecord.__add__.</span>

<span class="sd">        For magical behaviour, we assume that other is of the same _type as the self._type.</span>
<span class="sd">        Doing so allows us to do:</span>

<span class="sd">        ```python</span>
<span class="sd">        # `a` is SeqLike, `b` is of variable type</span>
<span class="sd">        a + b</span>
<span class="sd">        ```</span>

<span class="sd">        without specifying any further information.</span>

<span class="sd">        :param other: A SeqLike type object.</span>
<span class="sd">        :returns: The added SeqLike object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SeqLike</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">SeqLike</span><span class="p">(</span>
                <span class="n">other</span><span class="p">,</span>
                <span class="n">seq_type</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">),</span>
                <span class="n">alphabet</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="p">),</span>
                <span class="n">codon_map</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span><span class="p">),</span>
            <span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Incompatible sequence types! self is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="si">}</span><span class="s2">, other is </span><span class="si">{</span><span class="n">other</span><span class="o">.</span><span class="n">_type</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="n">SeqLike</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_seqrecord</span><span class="p">()</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">to_seqrecord</span><span class="p">(),</span>
            <span class="n">seq_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span>
            <span class="n">alphabet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="p">,</span>
            <span class="n">codon_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span><span class="p">,</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;SeqLike&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add another sequence or string to this sequence from the left.</span>

<span class="sd">        Mimics behavior of SeqRecord.__radd__.</span>

<span class="sd">        &lt;!-- #noqa: DAR101 --&gt;</span>
<span class="sd">        &lt;!-- #noqa: DAR201 --&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># for summation of SeqLike using sum()</span>
        <span class="k">if</span> <span class="n">other</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SeqLike</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This should have happened via the __add__ of the other SeqLike being added!&quot;</span><span class="p">)</span>
        <span class="c1"># Assume it is a string, Seq, or SeqRecord.</span>
        <span class="c1"># Note can&#39;t transfer any per-letter-annotations</span>
        <span class="k">return</span> <span class="n">SeqLike</span><span class="p">(</span>
            <span class="n">other</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_seqrecord</span><span class="p">(),</span>
            <span class="n">seq_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span>
            <span class="n">alphabet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="p">,</span>
            <span class="n">codon_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span><span class="p">,</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deepcopy implementation.</span>

<span class="sd">        &lt;!-- #noqa: DAR101 --&gt;</span>
<span class="sd">        &lt;!-- #noqa: DAR201 --&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">seq_copy</span> <span class="o">=</span> <span class="n">SeqLike</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">to_seqrecord</span><span class="p">(),</span>
            <span class="n">seq_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span>
            <span class="n">alphabet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="p">,</span>
            <span class="n">codon_map</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">seq_copy</span><span class="o">.</span><span class="n">_nt_record</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span><span class="p">)</span>
        <span class="n">seq_copy</span><span class="o">.</span><span class="n">_aa_record</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">seq_copy</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.__add__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Add sequence to another sequence.</p>
<p>Mimics behavior of SeqRecord.<strong>add</strong>.</p>
<p>For magical behaviour, we assume that other is of the same _type as the self._type.
Doing so allows us to do:</p>
<pre><code class="language-python"># `a` is SeqLike, `b` is of variable type
a + b
</code></pre>
<p>without specifying any further information.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>other</code></td>
          <td>
          </td>
          <td><p>A SeqLike type object.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td><p>The added SeqLike object.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add sequence to another sequence.</span>

<span class="sd">    Mimics behavior of SeqRecord.__add__.</span>

<span class="sd">    For magical behaviour, we assume that other is of the same _type as the self._type.</span>
<span class="sd">    Doing so allows us to do:</span>

<span class="sd">    ```python</span>
<span class="sd">    # `a` is SeqLike, `b` is of variable type</span>
<span class="sd">    a + b</span>
<span class="sd">    ```</span>

<span class="sd">    without specifying any further information.</span>

<span class="sd">    :param other: A SeqLike type object.</span>
<span class="sd">    :returns: The added SeqLike object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SeqLike</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">SeqLike</span><span class="p">(</span>
            <span class="n">other</span><span class="p">,</span>
            <span class="n">seq_type</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">),</span>
            <span class="n">alphabet</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="p">),</span>
            <span class="n">codon_map</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Incompatible sequence types! self is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="si">}</span><span class="s2">, other is </span><span class="si">{</span><span class="n">other</span><span class="o">.</span><span class="n">_type</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">return</span> <span class="n">SeqLike</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_seqrecord</span><span class="p">()</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">to_seqrecord</span><span class="p">(),</span>
        <span class="n">seq_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span>
        <span class="n">alphabet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="p">,</span>
        <span class="n">codon_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span><span class="p">,</span>
        <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.__deepcopy__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">__deepcopy__</span><span class="p">(</span><span class="n">memo</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Deepcopy implementation.</p>
<!-- #noqa: DAR101 -->
<!-- #noqa: DAR201 -->

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Deepcopy implementation.</span>

<span class="sd">    &lt;!-- #noqa: DAR101 --&gt;</span>
<span class="sd">    &lt;!-- #noqa: DAR201 --&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">seq_copy</span> <span class="o">=</span> <span class="n">SeqLike</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_seqrecord</span><span class="p">(),</span>
        <span class="n">seq_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span>
        <span class="n">alphabet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="p">,</span>
        <span class="n">codon_map</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">seq_copy</span><span class="o">.</span><span class="n">_nt_record</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span><span class="p">)</span>
    <span class="n">seq_copy</span><span class="o">.</span><span class="n">_aa_record</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">seq_copy</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.__dir__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__dir__</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Override for dir() of a SeqLike's attributes.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td><p>List of SeqLike attributes and SeqRecord attributes.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Override for dir() of a SeqLike&#39;s attributes.</span>

<span class="sd">    :returns: List of SeqLike attributes and SeqRecord attributes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__dir__</span><span class="p">()</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">seqrecord_attrs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.__getattr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__getattr__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Called if the attribute does not already exist in SeqLike</p>
<p>Please see <a href="https://docs.python.org/3/reference/datamodel.html">the official Python reference</a> for more information.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
          </td>
          <td><p>Attribute to return.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>AttributeError</code>
          </td>
          <td><p>if the attribute is not a SeqLike or SeqRecord attribute.  <!-- #noqa: DAR201 --></p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Called if the attribute does not already exist in SeqLike</span>

<span class="sd">    Please see [the official Python reference][pyref] for more information.</span>

<span class="sd">    [pyref]: https://docs.python.org/3/reference/datamodel.html</span>

<span class="sd">    :param name: Attribute to return.</span>
<span class="sd">    :raises AttributeError: if the attribute is not a SeqLike</span>
<span class="sd">        or SeqRecord attribute.</span>

<span class="sd">    &lt;!-- #noqa: DAR201 --&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;__setstate__&quot;</span><span class="p">:</span>  <span class="c1"># pertains to pickling</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span>

    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">seqrecord_attrs</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> not an attribute of SeqLike or SeqLike._seqrecord&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.__getitem__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p><strong>getitem</strong> implementation.</p>
<p>Slicing on SeqLike will slice the associated sequence
and return a sub-sequence SeqLike object.
We try to cast the SeqLike to NT if possible,
index,
and then create a new sequence out of that.
If the sub-sequence is not a multiple of three in length,
then there will be no AA sequence associated with the new SeqLike,
due to ambiguity of coding frame.
This is simply the default behavior of the SeqLike constructor.
Note that this <em>can</em> result in a new NT with AA that is out of frame,
the constructor doesn't know or care.</p>
<p>By convention, the indices here are in the "units" of the
current type of SeqLike, i.e. in NTs if DNA or RNA, or AAs if AA</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>index</code></td>
          <td>
          </td>
          <td><p>integer or slice to access parts of the sequence.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="seqlike.SeqLike.SeqLike" href="#seqlike.SeqLike.SeqLike">SeqLike</a></code>
          </td>
          <td><p>A new SeqLike of the same type sliced to the index.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SeqLike&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    __getitem__ implementation.</span>

<span class="sd">    Slicing on SeqLike will slice the associated sequence</span>
<span class="sd">    and return a sub-sequence SeqLike object.</span>
<span class="sd">    We try to cast the SeqLike to NT if possible,</span>
<span class="sd">    index,</span>
<span class="sd">    and then create a new sequence out of that.</span>
<span class="sd">    If the sub-sequence is not a multiple of three in length,</span>
<span class="sd">    then there will be no AA sequence associated with the new SeqLike,</span>
<span class="sd">    due to ambiguity of coding frame.</span>
<span class="sd">    This is simply the default behavior of the SeqLike constructor.</span>
<span class="sd">    Note that this *can* result in a new NT with AA that is out of frame,</span>
<span class="sd">    the constructor doesn&#39;t know or care.</span>

<span class="sd">    By convention, the indices here are in the &quot;units&quot; of the</span>
<span class="sd">    current type of SeqLike, i.e. in NTs if DNA or RNA, or AAs if AA</span>

<span class="sd">    :param index: integer or slice to access parts of the sequence.</span>
<span class="sd">    :returns: A new SeqLike of the same type sliced to the index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">slice</span><span class="p">))</span> <span class="k">else</span> <span class="n">index</span>

    <span class="c1"># slicing is a type-preserving</span>
    <span class="n">seqlike_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">seq_type</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">),</span>
        <span class="n">alphabet</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="p">),</span>
        <span class="n">codon_map</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="n">all_seqlikes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Handle case when both NT and AA are present:</span>
        <span class="c1"># - We need to slice BOTH the _nt_record and _aa_records.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Firstly, determine the primary and secondary records to slice based on _type</span>
            <span class="n">_aa_record</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span><span class="p">)</span>
            <span class="n">_nt_record</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;AA&quot;</span><span class="p">:</span>
                <span class="c1"># Slice the AA followed by 3x boundaries.for NT</span>
                <span class="n">_aa_record</span> <span class="o">=</span> <span class="n">_aa_record</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

                <span class="n">start</span> <span class="o">=</span> <span class="n">idx</span><span class="o">.</span><span class="n">start</span> <span class="ow">or</span> <span class="mi">0</span>
                <span class="n">stop</span> <span class="o">=</span> <span class="n">idx</span><span class="o">.</span><span class="n">stop</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">step</span> <span class="o">=</span> <span class="n">idx</span><span class="o">.</span><span class="n">step</span> <span class="ow">or</span> <span class="mi">1</span>

                <span class="n">new_nt_record</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">new_nt_record</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">new_nt_record</span> <span class="o">=</span> <span class="n">_nt_record</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="p">:</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">new_nt_record</span> <span class="o">=</span> <span class="n">new_nt_record</span> <span class="o">+</span> <span class="n">_nt_record</span><span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mi">3</span> <span class="p">:</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span><span class="p">]</span>

                <span class="n">sliced</span> <span class="o">=</span> <span class="n">SeqLike</span><span class="p">(</span><span class="n">_aa_record</span><span class="p">,</span> <span class="o">**</span><span class="n">seqlike_kwargs</span><span class="p">)</span>
                <span class="n">sliced</span><span class="o">.</span><span class="n">_nt_record</span> <span class="o">=</span> <span class="n">new_nt_record</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;NT&quot;</span><span class="p">:</span>
                <span class="n">_nt_record</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span><span class="p">)[</span><span class="n">idx</span><span class="p">]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">_aa_record</span> <span class="o">=</span> <span class="n">_nt_record</span><span class="o">.</span><span class="n">translate</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="n">sliced</span> <span class="o">=</span> <span class="n">SeqLike</span><span class="p">(</span><span class="n">_nt_record</span><span class="p">,</span> <span class="o">**</span><span class="n">seqlike_kwargs</span><span class="p">)</span>
                <span class="n">sliced</span><span class="o">.</span><span class="n">_aa_record</span> <span class="o">=</span> <span class="n">_aa_record</span>

        <span class="c1"># _aa_record is only present</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;AA&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sliced</span> <span class="o">=</span> <span class="n">SeqLike</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span><span class="p">)[</span><span class="n">idx</span><span class="p">],</span> <span class="o">**</span><span class="n">seqlike_kwargs</span><span class="p">)</span>

        <span class="c1"># _nt_record is only present</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;NT&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sliced</span> <span class="o">=</span> <span class="n">SeqLike</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span><span class="p">)[</span><span class="n">idx</span><span class="p">],</span> <span class="o">**</span><span class="n">seqlike_kwargs</span><span class="p">)</span>

        <span class="n">all_seqlikes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sliced</span><span class="p">)</span>

    <span class="c1"># all_seqlikes is now a list of SeqLikes that we need to concatenate</span>
    <span class="k">return</span> <span class="n">reduce</span><span class="p">((</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">),</span> <span class="n">all_seqlikes</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">seq_type</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">codon_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initialize a SeqLike object.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sequence</code></td>
          <td>
                <code><span title="seqlike.SeqLike.SeqLikeType">SeqLikeType</span></code>
          </td>
          <td><p>String, Seq, SeqRecord, SeqLike, List, NumPy ndarray, PyTorch Tensor</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>seq_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>one of 'NT', 'DNA', 'RNA' or 'AA', case insensitive</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>alphabet</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td><p>one of 'standard', 'full', or a custom string of alphabet letters</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>codon_map</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>]</code>
          </td>
          <td><p>a callable, see codon_tables.py for more info.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td><p>keyword arguments for internal SeqRecord attribute</p></td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">sequence</span><span class="p">:</span> <span class="n">SeqLikeType</span><span class="p">,</span>
    <span class="n">seq_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">alphabet</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">codon_map</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initialize a SeqLike object.</span>

<span class="sd">    :param sequence: String, Seq, SeqRecord, SeqLike, List, NumPy ndarray, PyTorch Tensor</span>
<span class="sd">    :param seq_type: one of &#39;NT&#39;, &#39;DNA&#39;, &#39;RNA&#39; or &#39;AA&#39;, case insensitive</span>
<span class="sd">    :param alphabet: one of &#39;standard&#39;, &#39;full&#39;, or a custom string of alphabet letters</span>
<span class="sd">    :param codon_map: a callable, see codon_tables.py for more info.</span>
<span class="sd">    :param **kwargs: keyword arguments for internal SeqRecord attribute</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="p">(</span>
        <span class="n">_type</span><span class="p">,</span>
        <span class="n">_aa_record</span><span class="p">,</span>
        <span class="n">_nt_record</span><span class="p">,</span>
        <span class="n">alphabet</span><span class="p">,</span>
        <span class="n">codon_map</span><span class="p">,</span>
        <span class="n">_index_encoder</span><span class="p">,</span>
        <span class="n">_onehot_encoder</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">=</span> <span class="n">_construct_seqlike</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">seq_type</span><span class="p">,</span> <span class="n">alphabet</span><span class="p">,</span> <span class="n">codon_map</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span> <span class="o">=</span> <span class="n">alphabet</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_index_encoder</span> <span class="o">=</span> <span class="n">_index_encoder</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_onehot_encoder</span> <span class="o">=</span> <span class="n">_onehot_encoder</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span> <span class="o">=</span> <span class="n">_aa_record</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span> <span class="o">=</span> <span class="n">_nt_record</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span> <span class="k">if</span> <span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;AA&quot;</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span> <span class="o">=</span> <span class="n">codon_map</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.__radd__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__radd__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Add another sequence or string to this sequence from the left.</p>
<p>Mimics behavior of SeqRecord.<strong>radd</strong>.</p>
<!-- #noqa: DAR101 -->
<!-- #noqa: DAR201 -->

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;SeqLike&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add another sequence or string to this sequence from the left.</span>

<span class="sd">    Mimics behavior of SeqRecord.__radd__.</span>

<span class="sd">    &lt;!-- #noqa: DAR101 --&gt;</span>
<span class="sd">    &lt;!-- #noqa: DAR201 --&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># for summation of SeqLike using sum()</span>
    <span class="k">if</span> <span class="n">other</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SeqLike</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;This should have happened via the __add__ of the other SeqLike being added!&quot;</span><span class="p">)</span>
    <span class="c1"># Assume it is a string, Seq, or SeqRecord.</span>
    <span class="c1"># Note can&#39;t transfer any per-letter-annotations</span>
    <span class="k">return</span> <span class="n">SeqLike</span><span class="p">(</span>
        <span class="n">other</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_seqrecord</span><span class="p">(),</span>
        <span class="n">seq_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span>
        <span class="n">alphabet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="p">,</span>
        <span class="n">codon_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span><span class="p">,</span>
        <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return a representation of the sequence.</p>
<p>If both nucleotide and an associated amino acid sequence are present,
we show both.</p>
<!-- #noqa: DAR201 -->

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Return a representation of the sequence.</span>

<span class="sd">    If both nucleotide and an associated amino acid sequence are present,</span>
<span class="sd">    we show both.</span>

<span class="sd">    &lt;!-- #noqa: DAR201 --&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;NT&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;*** NT: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="se">\n\n</span><span class="s2">AA: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;NT: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span><span class="si">}</span><span class="s2"> </span><span class="se">\n\n</span><span class="s2">*** AA: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.__setattr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Set attribute value</p>
<p>We prioritize setting attribute in _seqrecord before the SeqLike object.</p>
<!-- #noqa: DAR101 -->
<!-- #noqa: DAR201 -->

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set attribute value</span>

<span class="sd">    We prioritize setting attribute in _seqrecord before the SeqLike object.</span>

<span class="sd">    &lt;!-- #noqa: DAR101 --&gt;</span>
<span class="sd">    &lt;!-- #noqa: DAR201 --&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">seqrecord_attrs</span><span class="p">:</span>
        <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.aa" class="doc doc-heading">
<code class="highlight language-python"><span class="n">aa</span><span class="p">(</span><span class="n">auto_translate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return the amino acid view of the SeqLike object.</p>
<p>The method will automagically translate the <code>._nt_record</code>
of its SeqLike object if the <code>._aa_record</code> does not exist.</p>
<p>We preserve all NT record attributes for convenience in sequence manipulation
tasks where the starter sequence is an NT and we merely want the AA form.
The default behaviour, thus, has <code>id=True</code>, <code>name=True</code>, <code>description=True</code>,
<code>annotations=True</code>, and <code>dbxrefs=True</code>.</p>
<p>To change the behaviour,
you can set any of those to False in <code>.aa()</code>, for example:</p>
<pre><code class="language-python">seq.aa(id=False)
</code></pre>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>auto_translate</code></td>
          <td>
          </td>
          <td><p>Whether to automagically translate an NT sequence into an AA sequence. Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
          </td>
          <td><p>These kwargs are passed into BioPython SeqRecord's <code>.translate()</code> method.  The default behaviour is set to <code>id=True</code>, <code>name=True</code>, <code>description=True</code>, <code>annotations=True</code>, and <code>dbxrefs=True</code>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="seqlike.SeqLike.SeqLike" href="#seqlike.SeqLike.SeqLike">SeqLike</a></code>
          </td>
          <td><p>copy of self with sequence object as amino acid sequence.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">aa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auto_translate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SeqLike&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the amino acid view of the SeqLike object.</span>

<span class="sd">    The method will automagically translate the `._nt_record`</span>
<span class="sd">    of its SeqLike object if the `._aa_record` does not exist.</span>

<span class="sd">    We preserve all NT record attributes for convenience in sequence manipulation</span>
<span class="sd">    tasks where the starter sequence is an NT and we merely want the AA form.</span>
<span class="sd">    The default behaviour, thus, has `id=True`, `name=True`, `description=True`,</span>
<span class="sd">    `annotations=True`, and `dbxrefs=True`.</span>

<span class="sd">    To change the behaviour,</span>
<span class="sd">    you can set any of those to False in `.aa()`, for example:</span>

<span class="sd">    ```python</span>
<span class="sd">    seq.aa(id=False)</span>
<span class="sd">    ```</span>

<span class="sd">    :param auto_translate: Whether to automagically translate</span>
<span class="sd">        an NT sequence into an AA sequence.</span>
<span class="sd">        Defaults to True.</span>
<span class="sd">    :param kwargs: These kwargs are passed into BioPython SeqRecord&#39;s</span>
<span class="sd">        `.translate()` method.  The default behaviour is set to `id=True`,</span>
<span class="sd">        `name=True`, `description=True`, `annotations=True`, and `dbxrefs=True`.</span>
<span class="sd">    :returns: copy of self with sequence object as amino acid sequence.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Start with auto-translation</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">auto_translate</span><span class="p">:</span>
        <span class="n">translate_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">annotations</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dbxrefs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">translate_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="o">**</span><span class="n">translate_kwargs</span><span class="p">)</span>

    <span class="c1"># Return based on _type.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;AA&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">swap_representation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.back_translate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">back_translate</span><span class="p">(</span><span class="n">codon_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This method backtranslates the current AA sequence and returns an
NT sequence.</p>
<p>We expect that self.codon_map will be defined, and if not, we
expect a callable and its arguments to be passed into this
method, as either the first positional argument or by using
keyword arguments.  Any other arguments for the back
translator should use keyword arguments.</p>
<p>If <code>codon_map</code> is one of the keyword arguments or the sole
positional argument, we override self.codon_map, with the
associated value, and pass all kwargs through to it, along
with self.  Otherwise we use self.codon_map.</p>
<p>Finally, we use self.apply to apply the codon_map callable to
the current sequence.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>codon_map</code></td>
          <td>
                <code><span title="typing.Callable">Callable</span></code>
          </td>
          <td><p>A codon map callable.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td><p>Passed through to the codon_map function.</p></td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="seqlike.SeqLike.SeqLike" href="#seqlike.SeqLike.SeqLike">SeqLike</a></code>
          </td>
          <td><p>A new NT seqlike.</p></td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>AttributeError</code>
          </td>
          <td><p>if no codon map is passed in when the SeqLike's <code>codon_map</code> is also not set.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">back_translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">codon_map</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SeqLike&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;This method backtranslates the current AA sequence and returns an</span>
<span class="sd">    NT sequence.</span>

<span class="sd">    We expect that self.codon_map will be defined, and if not, we</span>
<span class="sd">    expect a callable and its arguments to be passed into this</span>
<span class="sd">    method, as either the first positional argument or by using</span>
<span class="sd">    keyword arguments.  Any other arguments for the back</span>
<span class="sd">    translator should use keyword arguments.</span>

<span class="sd">    If `codon_map` is one of the keyword arguments or the sole</span>
<span class="sd">    positional argument, we override self.codon_map, with the</span>
<span class="sd">    associated value, and pass all kwargs through to it, along</span>
<span class="sd">    with self.  Otherwise we use self.codon_map.</span>

<span class="sd">    Finally, we use self.apply to apply the codon_map callable to</span>
<span class="sd">    the current sequence.</span>

<span class="sd">    :param codon_map: A codon map callable.</span>
<span class="sd">    :param **kwargs: Passed through to the codon_map function.</span>
<span class="sd">    :returns: A new NT seqlike.</span>
<span class="sd">    :raises AttributeError: if no codon map is passed in</span>
<span class="sd">        when the SeqLike&#39;s `codon_map` is also not set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># normally, we wouldn&#39;t have to do this sort of thing, we could</span>
    <span class="c1"># just use self.__dict__ in the codon_map function.</span>

    <span class="c1"># but we might want to use a different codon_map than the original</span>
    <span class="c1"># object, so we have to copy and set codon_map in the copy as to not</span>
    <span class="c1"># modify in-place.</span>

    <span class="n">codon_map</span> <span class="o">=</span> <span class="n">codon_map</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span>

    <span class="k">if</span> <span class="n">codon_map</span><span class="p">:</span>
        <span class="n">validate_codon_map</span><span class="p">(</span><span class="n">codon_map</span><span class="p">)</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">codon_map</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># returns a deepcopied SeqLike</span>

        <span class="c1"># TODO: Change this to an if/raise block.</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">SeqLike</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sc</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;NT&quot;</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Backtranslating function must return an NT SeqLike, type was </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="s2">&quot;No callable passed and self.codon_map not set!  &quot;</span>
            <span class="s2">&quot;Please set the codon_map attribute or pass in a &quot;</span>
            <span class="s2">&quot;callable using the `codon_map` keyword.&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">sc</span><span class="o">.</span><span class="n">nt</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.nt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">nt</span><span class="p">(</span><span class="n">auto_backtranslate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This method returns the NT view of the SeqLike object.</p>
<p>The method will automagically back-translate the <code>._aa_record</code>
of its SeqLike object if the <code>._nt_record</code> does not exist.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>auto_backtranslate</code></td>
          <td>
          </td>
          <td><p>Whether or not to automagically back-translate an AA sequence into an NT sequence. Defaults to True.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
          </td>
          <td><p>Passed through to <code>.back_translate()</code>. Can include <code>codon_map</code> to specify which codon map to use.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="seqlike.SeqLike.SeqLike" href="#seqlike.SeqLike.SeqLike">SeqLike</a></code>
          </td>
          <td><p>The NT view of the object.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">nt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auto_backtranslate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SeqLike&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This method returns the NT view of the SeqLike object.</span>

<span class="sd">    The method will automagically back-translate the `._aa_record`</span>
<span class="sd">    of its SeqLike object if the `._nt_record` does not exist.</span>

<span class="sd">    :param auto_backtranslate: Whether or not</span>
<span class="sd">        to automagically back-translate an AA sequence into an NT sequence.</span>
<span class="sd">        Defaults to True.</span>
<span class="sd">    :param kwargs: Passed through to `.back_translate()`.</span>
<span class="sd">        Can include `codon_map` to specify which codon map to use.</span>
<span class="sd">    :returns: The NT view of the object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Start with auto-back-translation</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aa_record</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">auto_backtranslate</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">back_translate</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;NT&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">swap_representation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.pad_to" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pad_to</span><span class="p">(</span><span class="n">new_length</span><span class="p">,</span> <span class="n">pad_char</span><span class="o">=</span><span class="n">gap_letter</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This method returns a new SeqLike, with gap characters added to the left
or right to make a sequence of the specified length. Note that this method
retains only the current view!</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>new_length</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>An integer &gt;= than current length</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>pad_char</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The padding character</p></td>
          <td>
                <code>gap_letter</code>
          </td>
        </tr>
        <tr>
          <td><code>mode</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>one of 'left' or 'right'</p></td>
          <td>
                <code>&#39;right&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="seqlike.SeqLike.SeqLike" href="#seqlike.SeqLike.SeqLike">SeqLike</a></code>
          </td>
          <td><p>new SeqLike</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">pad_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">pad_char</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">gap_letter</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;right&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SeqLike&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;This method returns a new SeqLike, with gap characters added to the left</span>
<span class="sd">    or right to make a sequence of the specified length. Note that this method</span>
<span class="sd">    retains only the current view!</span>

<span class="sd">    :param new_length: An integer &gt;= than current length</span>
<span class="sd">    :param pad_char: The padding character</span>
<span class="sd">    :param mode: one of &#39;left&#39; or &#39;right&#39;</span>
<span class="sd">    :returns: new SeqLike</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_length</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">))</span>
    <span class="k">assert</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">]</span>

    <span class="n">diff</span> <span class="o">=</span> <span class="n">new_length</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">diff</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Current length is </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2"> and &quot;</span>
        <span class="s2">&quot;requested padded length is </span><span class="si">{new_length}</span><span class="s2">.&quot;</span>
        <span class="s2">&quot; Can&#39;t do negative padding&quot;</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SeqLike</span><span class="p">(</span>
            <span class="n">pad_char</span> <span class="o">*</span> <span class="n">diff</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="p">,</span>
            <span class="n">seq_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span>
            <span class="n">alphabet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="p">,</span>
            <span class="n">codon_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span><span class="p">,</span>
            <span class="n">index_encoder</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_index_encoder</span><span class="p">,</span>
            <span class="n">onehot_encoder</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_onehot_encoder</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">SeqLike</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span> <span class="o">+</span> <span class="n">pad_char</span> <span class="o">*</span> <span class="n">diff</span><span class="p">,</span>
            <span class="n">seq_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span>
            <span class="n">alphabet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="p">,</span>
            <span class="n">codon_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span><span class="p">,</span>
            <span class="n">index_encoder</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_index_encoder</span><span class="p">,</span>
            <span class="n">onehot_encoder</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_onehot_encoder</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.reverse_complement" class="doc doc-heading">
<code class="highlight language-python"><span class="n">reverse_complement</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return reverse complement of NT sequence.</p>
<p>Record this operation in annotations['reversed'].
If sequence is currently AA, raise exception like Bio.Seq.Seq.complement()</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td><p>Not currently used.</p></td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="seqlike.SeqLike.SeqLike" href="#seqlike.SeqLike.SeqLike">SeqLike</a></code>
          </td>
          <td><p>Reverse-complemented SeqLike object.</p></td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td><p>when trying to reverse-complement an AA sequence. This is a semantically invalid operation.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reverse_complement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SeqLike&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Return reverse complement of NT sequence.</span>

<span class="sd">    Record this operation in annotations[&#39;reversed&#39;].</span>
<span class="sd">    If sequence is currently AA, raise exception like Bio.Seq.Seq.complement()</span>

<span class="sd">    :param **kwargs: Not currently used.</span>
<span class="sd">    :returns: Reverse-complemented SeqLike object.</span>
<span class="sd">    :raises ValueError: when trying to reverse-complement an AA sequence.</span>
<span class="sd">        This is a semantically invalid operation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;AA&quot;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Proteins do not have complements!&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;annotations&quot;</span><span class="p">):</span>
        <span class="n">annotations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">annotations</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="k">if</span> <span class="s2">&quot;reversed&quot;</span> <span class="ow">in</span> <span class="n">annotations</span><span class="p">:</span>
        <span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;reversed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;reversed&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;reversed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">_nt_record</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nt_record</span><span class="o">.</span><span class="n">reverse_complement</span><span class="p">(</span>
        <span class="nb">id</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">annotations</span><span class="o">=</span><span class="n">annotations</span><span class="p">,</span> <span class="n">dbxrefs</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">SeqLike</span><span class="p">(</span>
        <span class="n">_nt_record</span><span class="p">,</span>
        <span class="n">seq_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span>
        <span class="n">alphabet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="p">,</span>
        <span class="n">codon_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.seq_num_to_idx" class="doc doc-heading">
<code class="highlight language-python"><span class="n">seq_num_to_idx</span><span class="p">(</span><span class="n">list_of_seqnums</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Convert seqnum to idx.</p>
<p>TODO: This docstring might need to be made better. tag Andrew Giessel.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>list_of_seqnums</code></td>
          <td>
          </td>
          <td><p>Something.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td><p>Something.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">seq_num_to_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_of_seqnums</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert seqnum to idx.</span>

<span class="sd">    TODO: This docstring might need to be made better. tag Andrew Giessel.</span>

<span class="sd">    :param list_of_seqnums: Something.</span>
<span class="sd">    :returns: Something.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">ranger</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;TODO: Docstrings need to be added here. tag Andrew Giessel.</span>

<span class="sd">        :param i: Something</span>
<span class="sd">        :yields: Something</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">b</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">yield</span> <span class="nb">slice</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">seqnums_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">seqnum</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">seqnum</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">letter_annotations</span><span class="p">[</span><span class="s2">&quot;seqnums&quot;</span><span class="p">]))</span>
    <span class="n">seqnums</span> <span class="o">=</span> <span class="p">[</span><span class="n">seqnums_map</span><span class="p">[</span><span class="n">seqnum</span><span class="p">]</span> <span class="k">for</span> <span class="n">seqnum</span> <span class="ow">in</span> <span class="n">list_of_seqnums</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">ranger</span><span class="p">(</span><span class="n">seqnums</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.slice" class="doc doc-heading">
<code class="highlight language-python"><span class="nb">slice</span><span class="p">(</span><span class="n">list_of_seqnums</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Use seqnums to sub-index.</p>
<p>TODO: This docstring needs to be much more improved.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>list_of_seqnums</code></td>
          <td>
          </td>
          <td><p>Something</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
          </td>
          <td><p>Something</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">slice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_of_seqnums</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Use seqnums to sub-index.</span>

<span class="sd">    TODO: This docstring needs to be much more improved.</span>

<span class="sd">    :param list_of_seqnums: Something</span>
<span class="sd">    :returns: Something</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seq_num_to_idx</span><span class="p">(</span><span class="n">list_of_seqnums</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.to_seq" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_seq</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Convert the SeqLike object (string, Seq, SeqRecord) to a BioPython Seq object.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="Bio.Seq.Seq">Seq</span></code>
          </td>
          <td><p>A Seq object.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_seq</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Seq</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert the SeqLike object (string, Seq, SeqRecord) to a BioPython Seq object.</span>

<span class="sd">    :returns: A Seq object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Seq</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span><span class="o">.</span><span class="n">seq</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.to_seqrecord" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_seqrecord</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Convert the SeqLike object (string, Seq, SeqRecord) to a BioPython SeqRecord.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td><p>Used to set the attributes of the SeqRecord. Overrides the original SeqRecord's attributes.</p></td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="Bio.SeqRecord.SeqRecord">SeqRecord</span></code>
          </td>
          <td><p>A SeqRecord object.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_seqrecord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SeqRecord</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert the SeqLike object (string, Seq, SeqRecord) to a BioPython SeqRecord.</span>

<span class="sd">    :param **kwargs: Used to set the attributes of the SeqRecord.</span>
<span class="sd">        Overrides the original SeqRecord&#39;s attributes.</span>
<span class="sd">    :returns: A SeqRecord object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seqrecord</span>
    <span class="n">newrec</span> <span class="o">=</span> <span class="n">SeqRecord</span><span class="p">(</span>
        <span class="n">Seq</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rec</span><span class="o">.</span><span class="n">seq</span><span class="p">)),</span>
        <span class="nb">id</span><span class="o">=</span><span class="n">rec</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">rec</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="n">rec</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
        <span class="n">dbxrefs</span><span class="o">=</span><span class="n">rec</span><span class="o">.</span><span class="n">dbxrefs</span><span class="p">[:],</span>
        <span class="n">features</span><span class="o">=</span><span class="n">rec</span><span class="o">.</span><span class="n">features</span><span class="p">[:],</span>
        <span class="n">annotations</span><span class="o">=</span><span class="n">rec</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
        <span class="n">letter_annotations</span><span class="o">=</span><span class="n">rec</span><span class="o">.</span><span class="n">letter_annotations</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
    <span class="p">)</span>
    <span class="c1"># overwrite newrec values with keyword args</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">newrec</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">newrec</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.translate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">translate</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Translate the SeqLike._nt_record and add a ._aa_record.</p>
<p>Returns the <code>.aa()</code> view of the SeqLike object.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>kwargs</code></td>
          <td>
          </td>
          <td><p>These kwargs are passed into BioPython SeqRecord's <code>.translate()</code> method. They can be used to set SeqRecord properties.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="seqlike.SeqLike.SeqLike" href="#seqlike.SeqLike.SeqLike">SeqLike</a></code>
          </td>
          <td><p>A translated SeqLike object.</p></td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td><p>When we're trying to translate a SeqLike object that doesn't have an NT record.</p></td>
        </tr>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td><p>When we're trying to translate a nucleotide sequence that isn't a multiple of 3.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SeqLike&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Translate the SeqLike._nt_record and add a ._aa_record.</span>

<span class="sd">    Returns the `.aa()` view of the SeqLike object.</span>

<span class="sd">    :param kwargs: These kwargs are passed into</span>
<span class="sd">        BioPython SeqRecord&#39;s `.translate()` method.</span>
<span class="sd">        They can be used to set SeqRecord properties.</span>
<span class="sd">    :returns: A translated SeqLike object.</span>
<span class="sd">    :raises ValueError: When we&#39;re trying to translate a SeqLike object</span>
<span class="sd">        that doesn&#39;t have an NT record.</span>
<span class="sd">    :raises TypeError: When we&#39;re trying to translate a nucleotide sequence</span>
<span class="sd">        that isn&#39;t a multiple of 3.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sc</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sc</span><span class="o">.</span><span class="n">_nt_record</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Oops! It looks like you&#39;re trying to translate a SeqLike object &quot;</span>
            <span class="s2">&quot;that doesn&#39;t have a nucleotide record set. &quot;</span>
            <span class="s2">&quot;Unfortunately this would be semantically incorrect. &quot;</span>
            <span class="s2">&quot;Please ensure that your SeqLike has a `._nt_record` SeqRecord &quot;</span>
            <span class="s2">&quot;before calling on `.translate()`.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s2">&quot;Oh no! It looks like you&#39;re trying to translate a nucleotide sequence &quot;</span>
            <span class="s2">&quot;whose length is not a multiple of 3. &quot;</span>
            <span class="s2">&quot;As a safeguard, SeqLike objects do not allow this to happen. &quot;</span>
        <span class="p">)</span>
    <span class="n">sc</span><span class="o">.</span><span class="n">_nt_record</span><span class="o">.</span><span class="n">annotations</span><span class="p">[</span><span class="s2">&quot;molecule_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;DNA&quot;</span>
    <span class="n">sc</span><span class="o">.</span><span class="n">_aa_record</span> <span class="o">=</span> <span class="n">record_from</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">_nt_record</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">gap</span><span class="o">=</span><span class="n">gap_letter</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">sc</span><span class="o">.</span><span class="n">aa</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.ungap" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ungap</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Remove gap characters and return a new SeqLike.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="seqlike.SeqLike.SeqLike" href="#seqlike.SeqLike.SeqLike">SeqLike</a></code>
          </td>
          <td><p>An ungapped SeqLike with no gap characters.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">ungap</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SeqLike&quot;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Remove gap characters and return a new SeqLike.</span>

<span class="sd">    :returns: An ungapped SeqLike with no gap characters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_seq</span> <span class="o">=</span> <span class="n">ungap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_seqrecord</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">SeqLike</span><span class="p">(</span>
        <span class="n">new_seq</span><span class="p">,</span>
        <span class="n">seq_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">,</span>
        <span class="n">alphabet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="p">,</span>
        <span class="n">codon_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">codon_map</span><span class="p">,</span>
        <span class="n">index_encoder</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_index_encoder</span><span class="p">,</span>
        <span class="n">onehot_encoder</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_onehot_encoder</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="seqlike.SeqLike.SeqLike.upper" class="doc doc-heading">
<code class="highlight language-python"><span class="n">upper</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return uppercase sequences and alphabet.</p>
<!-- #noqa: DAR201 -->

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">upper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return uppercase sequences and alphabet.</span>

<span class="sd">    &lt;!-- #noqa: DAR201 --&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">seq_copy</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">seq_copy</span><span class="o">.</span><span class="n">_seqrecord</span> <span class="o">=</span> <span class="n">seq_copy</span><span class="o">.</span><span class="n">_seqrecord</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">seq_copy</span><span class="o">.</span><span class="n">_nt_record</span><span class="p">:</span>
        <span class="n">seq_copy</span><span class="o">.</span><span class="n">_nt_record</span> <span class="o">=</span> <span class="n">seq_copy</span><span class="o">.</span><span class="n">_nt_record</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">seq_copy</span><span class="o">.</span><span class="n">_aa_record</span><span class="p">:</span>
        <span class="n">seq_copy</span><span class="o">.</span><span class="n">_aa_record</span> <span class="o">=</span> <span class="n">seq_copy</span><span class="o">.</span><span class="n">_aa_record</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">seq_copy</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">seq_copy</span><span class="o">.</span><span class="n">_type</span>
    <span class="n">seq_copy</span><span class="o">.</span><span class="n">alphabet</span> <span class="o">=</span> <span class="n">seq_copy</span><span class="o">.</span><span class="n">alphabet</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">seq_copy</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="seqlike.SeqLike.aaSeqLike" class="doc doc-heading">
<code class="highlight language-python"><span class="n">aaSeqLike</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">codon_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Entrypoint function for generating a SeqLike of seq_type=='aa', with the same call signature as the SeqLike
class.  Will coerce the sequence to AA.  Please see SeqLike for more info.</p>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">aaSeqLike</span><span class="p">(</span>
    <span class="n">sequence</span><span class="p">:</span> <span class="n">SeqLikeType</span><span class="p">,</span> <span class="n">alphabet</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">codon_map</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SeqLike</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Entrypoint function for generating a SeqLike of seq_type==&#39;aa&#39;, with the same call signature as the SeqLike</span>
<span class="sd">    class.  Will coerce the sequence to AA.  Please see SeqLike for more info.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;seq_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;AA&quot;</span><span class="p">]:</span>
            <span class="n">warn</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Trying to initialize an AA SeqLike, but seq_type is set to </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;seq_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">.  Coercing seq_type to AA&quot;</span>
            <span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;seq_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;AA&quot;</span>
    <span class="k">return</span> <span class="n">SeqLike</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="n">alphabet</span><span class="p">,</span> <span class="n">codon_map</span><span class="o">=</span><span class="n">codon_map</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="seqlike.SeqLike.determine__type" class="doc doc-heading">
<code class="highlight language-python"><span class="n">determine__type</span><span class="p">(</span><span class="n">alphabet</span><span class="p">,</span> <span class="n">sequence</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Determine _type when alphabet is set.</p>
<p>This function uses <em>only</em> the sequence to determine the alphabet.
We prioritize the amino acid representation where possible.</p>
<!-- #noqa: DAR101 -->
<!-- #noqa: DAR201 -->

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dispatch</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">StringLikeType</span><span class="o">.</span><span class="n">__args__</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">determine__type</span><span class="p">(</span><span class="n">alphabet</span><span class="p">,</span> <span class="n">sequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Determine _type when alphabet is set.</span>

<span class="sd">    This function uses _only_ the sequence to determine the alphabet.</span>
<span class="sd">    We prioritize the amino acid representation where possible.</span>

<span class="sd">    &lt;!-- #noqa: DAR101 --&gt;</span>
<span class="sd">    &lt;!-- #noqa: DAR201 --&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alphabet</span> <span class="o">==</span> <span class="n">AA</span> <span class="ow">or</span> <span class="n">alphabet</span> <span class="o">==</span> <span class="n">STANDARD_AA</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;AA&quot;</span>
    <span class="k">elif</span> <span class="n">alphabet</span> <span class="o">==</span> <span class="n">NT</span> <span class="ow">or</span> <span class="n">alphabet</span> <span class="o">==</span> <span class="n">STANDARD_NT</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;NT&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="seqlike.SeqLike.determine__type_and_alphabet" class="doc doc-heading">
<code class="highlight language-python"><span class="n">determine__type_and_alphabet</span><span class="p">(</span><span class="n">seq_type</span><span class="p">,</span> <span class="n">alphabet</span><span class="p">,</span> <span class="n">sequence</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Determine _type and alphabet when _type is set and alphabet is set.</p>
<!-- #noqa: DAR101 -->
<!-- #noqa: DAR201 -->

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dispatch</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">StringLikeType</span><span class="o">.</span><span class="n">__args__</span> <span class="o">+</span> <span class="n">ArrayType</span><span class="o">.</span><span class="n">__args__</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">determine__type_and_alphabet</span><span class="p">(</span><span class="n">seq_type</span><span class="p">,</span> <span class="n">alphabet</span><span class="p">,</span> <span class="n">sequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determine _type and alphabet when _type is set and alphabet is set.</span>

<span class="sd">    &lt;!-- #noqa: DAR101 --&gt;</span>
<span class="sd">    &lt;!-- #noqa: DAR201 --&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_type</span> <span class="o">=</span> <span class="n">SEQTYPE_TO_TYPE_MAPPING</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">seq_type</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_type</span><span class="p">,</span> <span class="n">alphabet</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="seqlike.SeqLike.determine_alphabet" class="doc doc-heading">
<code class="highlight language-python"><span class="n">determine_alphabet</span><span class="p">(</span><span class="n">_type</span><span class="p">,</span> <span class="n">sequence</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Determine alphabet from _type and sequence.</p>
<p>Enables us to use <em>type _and</em> sequence to control the alphabet.</p>
<!-- #noqa: DAR101 -->
<!-- #noqa: DAR201 -->

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dispatch</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">StringLikeType</span><span class="o">.</span><span class="n">__args__</span> <span class="o">+</span> <span class="p">(</span><span class="n">SeqLike</span><span class="p">,))</span>
<span class="k">def</span> <span class="nf">determine_alphabet</span><span class="p">(</span><span class="n">_type</span><span class="p">,</span> <span class="n">sequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Determine alphabet from _type and sequence.</span>

<span class="sd">    Enables us to use _type _and_ sequence to control the alphabet.</span>

<span class="sd">    &lt;!-- #noqa: DAR101 --&gt;</span>
<span class="sd">    &lt;!-- #noqa: DAR201 --&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># _type = determine_seq_type(seq_type, sequence)</span>
    <span class="n">alphabet</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NT&quot;</span><span class="p">:</span> <span class="n">NT</span><span class="p">,</span> <span class="s2">&quot;AA&quot;</span><span class="p">:</span> <span class="n">AA</span><span class="p">,</span> <span class="s2">&quot;DNA&quot;</span><span class="p">:</span> <span class="n">NT</span><span class="p">,</span> <span class="s2">&quot;RNA&quot;</span><span class="p">:</span> <span class="n">NT</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_type</span><span class="p">)</span>

    <span class="c1"># Finally, determine if we need to use the _standard_ versions of the alphabet.</span>
    <span class="k">if</span> <span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;NT&quot;</span> <span class="ow">and</span> <span class="n">is_STANDARD_NT</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
        <span class="n">alphabet</span> <span class="o">=</span> <span class="n">STANDARD_NT</span>
    <span class="k">elif</span> <span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;AA&quot;</span> <span class="ow">and</span> <span class="n">is_STANDARD_AA</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
        <span class="n">alphabet</span> <span class="o">=</span> <span class="n">STANDARD_AA</span>
    <span class="k">return</span> <span class="n">alphabet</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="seqlike.SeqLike.ntSeqLike" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ntSeqLike</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">codon_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Entrypoint function for generating a SeqLike of seq_type=='nt', with the same call signature as the SeqLike
class.  Will coerce the sequence to NT.  Please see SeqLike for more info.</p>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">ntSeqLike</span><span class="p">(</span>
    <span class="n">sequence</span><span class="p">:</span> <span class="n">SeqLikeType</span><span class="p">,</span> <span class="n">alphabet</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">codon_map</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SeqLike</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Entrypoint function for generating a SeqLike of seq_type==&#39;nt&#39;, with the same call signature as the SeqLike</span>
<span class="sd">    class.  Will coerce the sequence to NT.  Please see SeqLike for more info.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;seq_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;NT&quot;</span><span class="p">,</span> <span class="s2">&quot;RNA&quot;</span><span class="p">,</span> <span class="s2">&quot;DNA&quot;</span><span class="p">]:</span>
            <span class="n">warn</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Trying to initialize an NT SeqLike, but seq_type is set to </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;seq_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">.  Coercing seq_type to NT&quot;</span>
            <span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;seq_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;NT&quot;</span>
    <span class="k">return</span> <span class="n">SeqLike</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="n">alphabet</span><span class="p">,</span> <span class="n">codon_map</span><span class="o">=</span><span class="n">codon_map</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="seqlike.SeqLike.record_from" class="doc doc-heading">
<code class="highlight language-python"><span class="n">record_from</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Construct SeqRecord from SeqLike objects.</p>
<p>NOTE: This is one that is a bit weird but we might find it still useful.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>sequence</code></td>
          <td>
          </td>
          <td><p>A SeqLike object.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td><p>Passed through to SeqRecord constructor.</p></td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="Bio.SeqRecord.SeqRecord">SeqRecord</span></code>
          </td>
          <td><p>A SeqRecord object.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dispatch</span><span class="p">(</span><span class="n">SeqLike</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">record_from</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SeqRecord</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Construct SeqRecord from SeqLike objects.</span>

<span class="sd">    NOTE: This is one that is a bit weird but we might find it still useful.</span>

<span class="sd">    :param sequence: A SeqLike object.</span>
<span class="sd">    :param **kwargs: Passed through to SeqRecord constructor.</span>
<span class="sd">    :returns: A SeqRecord object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">record_from</span><span class="p">(</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">sequence</span><span class="o">.</span><span class="n">_seqrecord</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="seqlike.SeqLike.swap_representation" class="doc doc-heading">
<code class="highlight language-python"><span class="n">swap_representation</span><span class="p">(</span><span class="n">s</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Swap representation of a SeqLike object from NT to AA.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>s</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="seqlike.SeqLike.SeqLike" href="#seqlike.SeqLike.SeqLike">SeqLike</a></code>
          </td>
          <td><p>The SeqLike for which to swap representation.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="seqlike.SeqLike.SeqLike" href="#seqlike.SeqLike.SeqLike">SeqLike</a></code>
          </td>
          <td><p>A SeqLike with swapped representation.</p></td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ValueError</code>
          </td>
          <td><p>When either the _aa_record or _nt_record is missing.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">swap_representation</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="n">SeqLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SeqLike</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Swap representation of a SeqLike object from NT to AA.</span>

<span class="sd">    :param s: The SeqLike for which to swap representation.</span>
<span class="sd">    :returns: A SeqLike with swapped representation.</span>
<span class="sd">    :raises ValueError: When either the _aa_record or _nt_record is missing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">_aa_record</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">s</span><span class="o">.</span><span class="n">_nt_record</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Raise an informative error message.</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Oops! It looks like the SeqLike object is missing &quot;</span>
            <span class="s2">&quot;one of `._aa_record` or `._nt_record`.&quot;</span>
            <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Here are the values for you to inspect: </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;- SeqLike._aa_record: </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">_aa_record</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;- SeqLike._nt_record: </span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">_nt_record</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Without both representations present, we can&#39;t swap views. &quot;</span>
            <span class="s1">&#39;If your SeqLike object is of sequence type &quot;NT&quot;, &#39;</span>
            <span class="s2">&quot;please `.translate()` it first; &quot;</span>
            <span class="s1">&#39;alternatively if your SeqLike object is of sequence type &quot;AA&quot;, &#39;</span>
            <span class="s2">&quot;please `.back_translate()` it first.&quot;</span>
        <span class="p">)</span>
    <span class="n">sc</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  <span class="c1"># sc == &quot;seq copy&quot;</span>

    <span class="c1"># swap the _type</span>
    <span class="n">_type</span> <span class="o">=</span> <span class="s2">&quot;NT&quot;</span> <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;AA&quot;</span> <span class="k">else</span> <span class="s2">&quot;AA&quot;</span>

    <span class="c1"># copy over the _aa_record and _nt_record objects.</span>
    <span class="n">_aa_record</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">_aa_record</span><span class="p">)</span>
    <span class="n">_nt_record</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">_nt_record</span><span class="p">)</span>

    <span class="c1"># swap out the alphabets</span>
    <span class="c1"># When swapping representations, standard aa -&gt; standard nt, aa -&gt; nt, etc.</span>
    <span class="n">alphabet_mapping</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">STANDARD_AA</span><span class="p">:</span> <span class="n">STANDARD_NT</span><span class="p">,</span>
        <span class="n">STANDARD_NT</span><span class="p">:</span> <span class="n">STANDARD_AA</span><span class="p">,</span>
        <span class="n">NT</span><span class="p">:</span> <span class="n">AA</span><span class="p">,</span>
        <span class="n">AA</span><span class="p">:</span> <span class="n">NT</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">alphabet</span> <span class="o">=</span> <span class="n">alphabet_mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">alphabet</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Switching between AA and NT views supported only when using &quot;</span>
            <span class="s2">&quot;the standard alphabets provided in the SeqLike library. &quot;</span>
            <span class="s2">&quot;This ensures that we can swap the alphabets correctly, &quot;</span>
            <span class="s2">&quot;and thus also swap the encoders correctly. &quot;</span>
            <span class="s2">&quot;If you are using a custom alphabet, &quot;</span>
            <span class="s2">&quot;please set the encoders manually.&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Obtain new encoders</span>
    <span class="n">_index_encoder</span> <span class="o">=</span> <span class="n">index_encoder_from_alphabet</span><span class="p">(</span><span class="n">alphabet</span><span class="p">)</span>
    <span class="n">_onehot_encoder</span> <span class="o">=</span> <span class="n">onehot_encoder_from_alphabet</span><span class="p">(</span><span class="n">alphabet</span><span class="p">)</span>

    <span class="c1"># Now set the attributes correctly.</span>
    <span class="n">sc</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">_type</span>
    <span class="n">sc</span><span class="o">.</span><span class="n">alphabet</span> <span class="o">=</span> <span class="n">alphabet</span>
    <span class="n">sc</span><span class="o">.</span><span class="n">_index_encoder</span> <span class="o">=</span> <span class="n">_index_encoder</span>
    <span class="n">sc</span><span class="o">.</span><span class="n">_onehot_encoder</span> <span class="o">=</span> <span class="n">_onehot_encoder</span>
    <span class="n">sc</span><span class="o">.</span><span class="n">_aa_record</span> <span class="o">=</span> <span class="n">_aa_record</span>
    <span class="n">sc</span><span class="o">.</span><span class="n">_nt_record</span> <span class="o">=</span> <span class="n">_nt_record</span>
    <span class="n">sc</span><span class="o">.</span><span class="n">_seqrecord</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">_aa_record</span> <span class="k">if</span> <span class="n">_type</span> <span class="o">==</span> <span class="s2">&quot;AA&quot;</span> <span class="k">else</span> <span class="n">sc</span><span class="o">.</span><span class="n">_nt_record</span>
    <span class="c1"># Codon map doesn&#39;t need to be changed so we do not explicitly set it here.</span>
    <span class="k">return</span> <span class="n">sc</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="seqlike.SeqLike.validate_codon_map" class="doc doc-heading">
<code class="highlight language-python"><span class="n">validate_codon_map</span><span class="p">(</span><span class="n">codon_map</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Validate that codon_map is a callable.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>codon_map</code></td>
          <td>
          </td>
          <td><p>A codon map callable.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td><p>when the codon map is not a Callable.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">validate_codon_map</span><span class="p">(</span><span class="n">codon_map</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Validate that codon_map is a callable.</span>

<span class="sd">    :param codon_map: A codon map callable.</span>
<span class="sd">    :raises TypeError: when the codon map is not a Callable.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">err_msg</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;An explicitly passed-in codon_map must be a callable, for e.g., &quot;</span>
        <span class="s2">&quot;the output of codon_table_to_codon_map(codon_table). &quot;</span>
        <span class="s2">&quot;Did you pass in a codon table dictionary instead? &quot;</span>
        <span class="s2">&quot;If so, please pass the dictionary through `codon_table_to_codon_map` first &quot;</span>
        <span class="s2">&quot;and pass in the resulting function to the `codon_map` argument.&quot;</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">codon_map</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">codon_map</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">err_msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="seqlike.SeqLike.validate_sequence" class="doc doc-heading">
<code class="highlight language-python"><span class="n">validate_sequence</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">_type</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>We do not need to validate SeqLike sequences. (I think.)</p>
<!-- #noqa: DAR101 -->

      <details class="quote">
        <summary>Source code in <code>seqlike/SeqLike.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dispatch</span><span class="p">(</span><span class="n">SeqLike</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">validate_sequence</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">_type</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;We do not need to validate SeqLike sequences. (I think.)</span>

<span class="sd">    &lt;!-- #noqa: DAR101 --&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../encoders/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Encoders" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Encoders
            </div>
          </div>
        </a>
      
      
        
        <a href="../seqlike_accessor/" class="md-footer__link md-footer__link--next" aria-label="Next: SeqLike Accessor API" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              SeqLike Accessor API
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["instant", "tabs"], "search": "../../assets/javascripts/workers/search.0bbba5b5.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.e1a181d9.min.js"></script>
      
    
  </body>
</html>